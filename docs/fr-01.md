# Results Filter Panel & Advanced Multi-Select Control

- [ ] Redesign the ResultsView filter section as a right-side panel, mirroring the details panel layout.
- [ ] Implement a reusable, searchable, scrollable, multi-select list control for log level, source, and log filters with:
    - Cross-filtering support: each item shows a dynamic count of matching items in the current filtered set, updating as other filters change.
    - Inline buttons in the search box for "show only selected" and "select all visible".
    - Search box filters visible items.
    - Virtualized list for large collections.
    - Keyboard and mouse accessibility.
    - Styleable to match app theme.
- [ ] Integrate the new control into the right-side filter panel, alongside existing grouping checkboxes, message search box, and a placeholder for future time filter UI.
- [ ] (Future) Design and implement a time-dimension filter UI (e.g., range picker or slider).

---
---
---
## AdvancedMultiSelectControl: Requirements & API

**Features:**
- Reusable WPF UserControl for multi-selecting items from a large list.
- Search box filters visible items in real time.
- Each item displays a dynamic count of matching items in the current filtered set (cross-filtering).
- Inline buttons in the search box: "Show only selected", "Select all visible".
- Virtualized list for performance with large collections.
- Keyboard and mouse accessible (tab, arrow keys, space/enter, screen reader).
- Fully styleable to match app theme.

**Accessibility & Theming:**
- All controls use theme resources for background/foreground.
- All icon-only buttons have tooltips and AutomationProperties for screen readers.
- Tab order and keyboard navigation are logical and accessible.
- Controls have AutomationProperties.Name and HelpText where appropriate.

**API:**
- `ItemsSource` (IEnumerable): All possible items.
- `SelectedItems` (IList, two-way): The selected items.
- `ItemCountProvider` (Func<object, int>): Returns the count for each item in the current filter context.
- `SearchText` (string, two-way): Current search/filter text.
- `ShowOnlySelected` (bool, two-way): Toggle to show only selected items.
- `SelectAllVisibleCommand` (ICommand): Command to select all currently visible items.
- `ItemTemplate` (DataTemplate): For custom item rendering.
- `PlaceholderText` (string): For the search box.
- `Header` (string): Optional label.

**Events:**
- `SelectionChanged`
- `SearchTextChanged`
## Right-Side Filter Panel Design (Draft)

- The filter panel will be a `DockPanel` or `StackPanel` docked to the right of the ResultsView main area, visually mirroring the details panel.
- It will contain, in order:
  1. **AdvancedMultiSelectControl** for Log Level (with search, dynamic counts, select all, show only selected).
  2. **AdvancedMultiSelectControl** for Source.
  3. **AdvancedMultiSelectControl** for Log Name.
  4. Grouping checkboxes ("Group by Log", "Group by Level").
  5. Message search box.
  6. Placeholder for future time filter UI.
- The panel will be collapsible and styleable to match the app theme.
- Accessibility: All controls will be keyboard and screen-reader accessible.
- The main DataGrid will resize to accommodate the filter panel.
## Current ResultsView Filter Section Analysis

- The filter section is currently a horizontal grid at the top of the main panel.
- Controls include:
  - ComboBox for log level selection, bound to `LogLevels` and `SelectedLogLevels` in `ResultsViewModel`.
  - TextBox for message search, bound to `SearchText`.
  - CheckBoxes for grouping by log and level, bound to `IsGroupingEnabled` and `IsGroupByLevelEnabled`.
  - CheckBox for "Show Only Checked", bound to `ShowOnlyChecked` and enabled if `HasCheckedRows`.
- The ComboBox uses a custom template for multi-select, but lacks search, virtualization, and advanced features.
- All filter controls are in a single row, not in a side panel.
- No reusable advanced multi-select control is present.
